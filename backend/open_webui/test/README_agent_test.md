# Agent æ¨¡å¼æµ‹è¯•è„šæœ¬

## æ¦‚è¿°

`test_agent_mode.py` æ˜¯ä¸€ä¸ªæµ‹è¯•è„šæœ¬ï¼Œç”¨äºæµ‹è¯•ä½¿ç”¨ LangGraph è¿è¡Œ Agent æ¨¡å¼å¹¶è°ƒç”¨å·¥å…·ã€‚

## åŠŸèƒ½

1. **åˆ—å‡ºæ‰€æœ‰å¯ç”¨å·¥å…·** - æŸ¥çœ‹ç³»ç»Ÿä¸­æ³¨å†Œçš„æ‰€æœ‰å·¥å…·
2. **æµ‹è¯• Agent æ¨¡å¼** - ä½¿ç”¨ LangGraph æ‰§è¡Œ Agent å·¥ä½œæµï¼Œè°ƒç”¨æŒ‡å®šçš„å·¥å…·

## ä½¿ç”¨æ–¹æ³•

### 1. åˆ—å‡ºæ‰€æœ‰å¯ç”¨å·¥å…·

```bash
cd backend
python -m open_webui.test.test_agent_mode --list-tools
```

è¿™å°†æ˜¾ç¤ºç³»ç»Ÿä¸­æ‰€æœ‰å¯ç”¨çš„å·¥å…·ï¼ŒåŒ…æ‹¬å·¥å…·IDã€åç§°å’Œæè¿°ã€‚

### 2. æµ‹è¯• Agent æ¨¡å¼ï¼ˆè°ƒç”¨ä¸¤ä¸ªå·¥å…·ï¼‰

```bash
cd backend
python -m open_webui.test.test_agent_mode \
    --tool-ids tool_id_1 tool_id_2 \
    --question "ä½ çš„é—®é¢˜" \
    --model-id "gpt-4"  # å¯é€‰
```

ä¾‹å¦‚ï¼š
```bash
python -m open_webui.test.test_agent_mode \
    --tool-ids searchaftersale delivery_prediction \
    --question "æŸ¥è¯¢å”®åä¿¡æ¯å¹¶é¢„æµ‹äº¤ä»˜æ—¶é—´"
```

### 3. å‚æ•°è¯´æ˜

- `--question`: ç”¨æˆ·é—®é¢˜ï¼ˆé»˜è®¤ï¼š"æµ‹è¯•é—®é¢˜ï¼šè¯·å¸®æˆ‘æŸ¥è¯¢ä¸€äº›ä¿¡æ¯"ï¼‰
- `--tool-ids`: å·¥å…·IDåˆ—è¡¨ï¼ˆè‡³å°‘éœ€è¦2ä¸ªå·¥å…·ï¼Œå¿…éœ€ï¼‰
- `--model-id`: æ¨¡å‹IDï¼ˆå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨é…ç½®çš„æ¨¡å‹ï¼‰
- `--list-tools`: åˆ—å‡ºæ‰€æœ‰å¯ç”¨å·¥å…·

## è¾“å‡ºè¯´æ˜

æµ‹è¯•è„šæœ¬ä¼šè¾“å‡ºï¼š

1. **å·¥å…·æ£€æŸ¥ç»“æœ** - æ˜¾ç¤ºå·¥å…·æ˜¯å¦å­˜åœ¨
2. **æ‰§è¡Œè¿‡ç¨‹** - å®æ—¶æ˜¾ç¤ºæ¯ä¸ªèŠ‚ç‚¹çš„å¼€å§‹å’Œç»“æŸ
3. **Agent å›ç­”** - æœ€ç»ˆçš„ Agent å›ç­”
4. **å·¥å…·è°ƒç”¨ç»“æœ** - æ¯ä¸ªå·¥å…·çš„æ‰§è¡Œç»“æœ
5. **æ‰§è¡Œæ­¥éª¤** - å·¥ä½œæµçš„æ‰§è¡Œè·¯å¾„
6. **æ‰§è¡Œæ—¶é—´** - å„ä¸ªèŠ‚ç‚¹çš„è€—æ—¶ç»Ÿè®¡

## ç¤ºä¾‹è¾“å‡º

```
================================================================================
å¼€å§‹æµ‹è¯• Agent æ¨¡å¼
================================================================================
é—®é¢˜: æŸ¥è¯¢å”®åä¿¡æ¯å¹¶é¢„æµ‹äº¤ä»˜æ—¶é—´
å·¥å…·ID: ['searchaftersale', 'delivery_prediction']
æ¨¡å‹ID: gpt-4

æ£€æŸ¥å·¥å…·æ˜¯å¦å­˜åœ¨...
ç³»ç»Ÿä¸­æ€»å…±æœ‰ 5 ä¸ªå·¥å…·
âœ“ å·¥å…·å­˜åœ¨: searchaftersale (å”®åæŸ¥è¯¢å·¥å…·)
âœ“ å·¥å…·å­˜åœ¨: delivery_prediction (äº¤ä»˜é¢„æµ‹å·¥å…·)

ä½¿ç”¨ç”¨æˆ·: Test User (test_user_1)

================================================================================
å¼€å§‹æ‰§è¡Œ Agent å·¥ä½œæµ...
================================================================================

ğŸš€ èŠ‚ç‚¹å¼€å§‹: Input (input_1)
âœ… èŠ‚ç‚¹å®Œæˆ: Input (input_1) - è€—æ—¶: 2.34ms
ğŸš€ èŠ‚ç‚¹å¼€å§‹: searchaftersale (tool_1)
âœ… èŠ‚ç‚¹å®Œæˆ: searchaftersale (tool_1) - è€—æ—¶: 1234.56ms
ğŸš€ èŠ‚ç‚¹å¼€å§‹: delivery_prediction (tool_2)
âœ… èŠ‚ç‚¹å®Œæˆ: delivery_prediction (tool_2) - è€—æ—¶: 2345.67ms
ğŸš€ èŠ‚ç‚¹å¼€å§‹: LLM (llm_1)
âœ… èŠ‚ç‚¹å®Œæˆ: LLM (llm_1) - è€—æ—¶: 3456.78ms
ğŸš€ èŠ‚ç‚¹å¼€å§‹: Output (output_1)
âœ… èŠ‚ç‚¹å®Œæˆ: Output (output_1) - è€—æ—¶: 1.23ms

================================================================================
Agent æ‰§è¡Œå®Œæˆ
================================================================================

ğŸ“ Agent å›ç­”:
--------------------------------------------------------------------------------
æ ¹æ®æŸ¥è¯¢ç»“æœï¼Œå”®åä¿¡æ¯å¦‚ä¸‹ï¼š...ï¼ˆå›ç­”å†…å®¹ï¼‰
--------------------------------------------------------------------------------

ğŸ”§ å·¥å…·è°ƒç”¨ç»“æœ (2 ä¸ª):

  1. searchaftersale - âœ… æˆåŠŸ
     ç»“æœ: {...}

  2. delivery_prediction - âœ… æˆåŠŸ
     ç»“æœ: {...}

ğŸ“Š æ‰§è¡Œæ­¥éª¤ (5 ä¸ª):
  1. Input (input_1)
  2. searchaftersale (tool_1)
  3. delivery_prediction (tool_2)
  4. LLM (llm_1)
  5. Output (output_1)

â±ï¸  æ‰§è¡Œæ—¶é—´:
  node_input_1: 2.34ms
  node_tool_1: 1234.56ms
  node_tool_2: 2345.67ms
  node_llm_1: 3456.78ms
  node_output_1: 1.23ms
  total: 7039.58ms
```

## æ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒè¦æ±‚**: ç¡®ä¿å·²å®‰è£…æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…æ‹¬ `langgraph`
2. **æ•°æ®åº“è¿æ¥**: æµ‹è¯•éœ€è¦æ•°æ®åº“è¿æ¥ä»¥è·å–å·¥å…·åˆ—è¡¨
3. **å·¥å…·ID**: å·¥å…·IDå¿…é¡»å­˜åœ¨äºç³»ç»Ÿä¸­ï¼Œå¯ä»¥é€šè¿‡ `--list-tools` æŸ¥çœ‹
4. **æ¨¡å‹é…ç½®**: å¦‚æœä½¿ç”¨ `--model-id`ï¼Œç¡®ä¿è¯¥æ¨¡å‹å·²é…ç½®

## æ•…éšœæ’é™¤

### é—®é¢˜1: æ¨¡å—æœªæ‰¾åˆ° (ModuleNotFoundError)

ç¡®ä¿åœ¨æ­£ç¡®çš„ç¯å¢ƒä¸­è¿è¡Œï¼Œå¹¶å®‰è£…äº†æ‰€æœ‰ä¾èµ–ï¼š
```bash
pip install langgraph langchain-core
```

### é—®é¢˜2: å·¥å…·ä¸å­˜åœ¨

ä½¿ç”¨ `--list-tools` æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å·¥å…·ï¼Œç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„å·¥å…·IDã€‚

### é—®é¢˜3: æ•°æ®åº“è¿æ¥é”™è¯¯

ç¡®ä¿æ•°æ®åº“å·²æ­£ç¡®é…ç½®ä¸”å¯ä»¥è®¿é—®ã€‚

